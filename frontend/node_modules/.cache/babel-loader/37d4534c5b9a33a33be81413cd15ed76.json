{"ast":null,"code":"import { extends as _extends, objectWithoutPropertiesLoose as _objectWithoutPropertiesLoose } from '../../_virtual/_rollupPluginBabelHelpers.js';\nimport React, { useReducer, createRef, useMemo, createContext, useCallback, useRef, useContext, Fragment } from 'react';\nimport { match } from '../../utils/match.esm.js';\nimport { render, forwardRefWithAs, Features } from '../../utils/render.esm.js';\nimport { useSyncRefs } from '../../hooks/use-sync-refs.esm.js';\nimport { Keys } from '../keyboard.esm.js';\nimport { isDisabledReactIssue7711 } from '../../utils/bugs.esm.js';\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect.esm.js';\nimport { useId } from '../../hooks/use-id.esm.js';\nimport { isFocusableElement, FocusableMode } from '../../utils/focus-management.esm.js';\nimport { useWindowEvent } from '../../hooks/use-window-event.esm.js';\nimport { OpenClosedProvider, State, useOpenClosed } from '../../internal/open-closed.esm.js';\nimport { useResolveButtonType } from '../../hooks/use-resolve-button-type.esm.js';\nimport { disposables } from '../../utils/disposables.esm.js';\nimport { useDisposables } from '../../hooks/use-disposables.esm.js';\nimport { useComputed } from '../../hooks/use-computed.esm.js';\nimport { calculateActiveIndex, Focus } from '../../utils/calculate-active-index.esm.js';\nvar _reducers;\nvar ListboxStates;\n(function (ListboxStates) {\n  ListboxStates[ListboxStates[\"Open\"] = 0] = \"Open\";\n  ListboxStates[ListboxStates[\"Closed\"] = 1] = \"Closed\";\n})(ListboxStates || (ListboxStates = {}));\nvar ActionTypes;\n(function (ActionTypes) {\n  ActionTypes[ActionTypes[\"OpenListbox\"] = 0] = \"OpenListbox\";\n  ActionTypes[ActionTypes[\"CloseListbox\"] = 1] = \"CloseListbox\";\n  ActionTypes[ActionTypes[\"SetDisabled\"] = 2] = \"SetDisabled\";\n  ActionTypes[ActionTypes[\"SetOrientation\"] = 3] = \"SetOrientation\";\n  ActionTypes[ActionTypes[\"GoToOption\"] = 4] = \"GoToOption\";\n  ActionTypes[ActionTypes[\"Search\"] = 5] = \"Search\";\n  ActionTypes[ActionTypes[\"ClearSearch\"] = 6] = \"ClearSearch\";\n  ActionTypes[ActionTypes[\"RegisterOption\"] = 7] = \"RegisterOption\";\n  ActionTypes[ActionTypes[\"UnregisterOption\"] = 8] = \"UnregisterOption\";\n})(ActionTypes || (ActionTypes = {}));\nvar reducers = (_reducers = {}, _reducers[ActionTypes.CloseListbox] = function (state) {\n  if (state.disabled) return state;\n  if (state.listboxState === ListboxStates.Closed) return state;\n  return _extends({}, state, {\n    activeOptionIndex: null,\n    listboxState: ListboxStates.Closed\n  });\n}, _reducers[ActionTypes.OpenListbox] = function (state) {\n  if (state.disabled) return state;\n  if (state.listboxState === ListboxStates.Open) return state;\n  return _extends({}, state, {\n    listboxState: ListboxStates.Open\n  });\n}, _reducers[ActionTypes.SetDisabled] = function (state, action) {\n  if (state.disabled === action.disabled) return state;\n  return _extends({}, state, {\n    disabled: action.disabled\n  });\n}, _reducers[ActionTypes.SetOrientation] = function (state, action) {\n  if (state.orientation === action.orientation) return state;\n  return _extends({}, state, {\n    orientation: action.orientation\n  });\n}, _reducers[ActionTypes.GoToOption] = function (state, action) {\n  if (state.disabled) return state;\n  if (state.listboxState === ListboxStates.Closed) return state;\n  var activeOptionIndex = calculateActiveIndex(action, {\n    resolveItems: function resolveItems() {\n      return state.options;\n    },\n    resolveActiveIndex: function resolveActiveIndex() {\n      return state.activeOptionIndex;\n    },\n    resolveId: function resolveId(item) {\n      return item.id;\n    },\n    resolveDisabled: function resolveDisabled(item) {\n      return item.dataRef.current.disabled;\n    }\n  });\n  if (state.searchQuery === '' && state.activeOptionIndex === activeOptionIndex) return state;\n  return _extends({}, state, {\n    searchQuery: '',\n    activeOptionIndex: activeOptionIndex\n  });\n}, _reducers[ActionTypes.Search] = function (state, action) {\n  if (state.disabled) return state;\n  if (state.listboxState === ListboxStates.Closed) return state;\n  var searchQuery = state.searchQuery + action.value.toLowerCase();\n  var match = state.options.findIndex(function (option) {\n    var _option$dataRef$curre;\n    return !option.dataRef.current.disabled && ((_option$dataRef$curre = option.dataRef.current.textValue) == null ? void 0 : _option$dataRef$curre.startsWith(searchQuery));\n  });\n  if (match === -1 || match === state.activeOptionIndex) return _extends({}, state, {\n    searchQuery: searchQuery\n  });\n  return _extends({}, state, {\n    searchQuery: searchQuery,\n    activeOptionIndex: match\n  });\n}, _reducers[ActionTypes.ClearSearch] = function (state) {\n  if (state.disabled) return state;\n  if (state.listboxState === ListboxStates.Closed) return state;\n  if (state.searchQuery === '') return state;\n  return _extends({}, state, {\n    searchQuery: ''\n  });\n}, _reducers[ActionTypes.RegisterOption] = function (state, action) {\n  return _extends({}, state, {\n    options: [].concat(state.options, [{\n      id: action.id,\n      dataRef: action.dataRef\n    }])\n  });\n}, _reducers[ActionTypes.UnregisterOption] = function (state, action) {\n  var nextOptions = state.options.slice();\n  var currentActiveOption = state.activeOptionIndex !== null ? nextOptions[state.activeOptionIndex] : null;\n  var idx = nextOptions.findIndex(function (a) {\n    return a.id === action.id;\n  });\n  if (idx !== -1) nextOptions.splice(idx, 1);\n  return _extends({}, state, {\n    options: nextOptions,\n    activeOptionIndex: function () {\n      if (idx === state.activeOptionIndex) return null;\n      if (currentActiveOption === null) return null; // If we removed the option before the actual active index, then it would be out of sync. To\n      // fix this, we will find the correct (new) index position.\n\n      return nextOptions.indexOf(currentActiveOption);\n    }()\n  });\n}, _reducers);\nvar ListboxContext = /*#__PURE__*/createContext(null);\nListboxContext.displayName = 'ListboxContext';\nfunction useListboxContext(component) {\n  var context = useContext(ListboxContext);\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <\" + Listbox.name + \" /> component.\");\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useListboxContext);\n    throw err;\n  }\n  return context;\n}\nfunction stateReducer(state, action) {\n  return match(action.type, reducers, state, action);\n} // ---\n\nvar DEFAULT_LISTBOX_TAG = Fragment;\nfunction Listbox(props) {\n  var _match;\n  var value = props.value,\n    onChange = props.onChange,\n    _props$disabled = props.disabled,\n    disabled = _props$disabled === void 0 ? false : _props$disabled,\n    _props$horizontal = props.horizontal,\n    horizontal = _props$horizontal === void 0 ? false : _props$horizontal,\n    passThroughProps = _objectWithoutPropertiesLoose(props, [\"value\", \"onChange\", \"disabled\", \"horizontal\"]);\n  var orientation = horizontal ? 'horizontal' : 'vertical';\n  var reducerBag = useReducer(stateReducer, {\n    listboxState: ListboxStates.Closed,\n    propsRef: {\n      current: {\n        value: value,\n        onChange: onChange\n      }\n    },\n    labelRef: createRef(),\n    buttonRef: createRef(),\n    optionsRef: createRef(),\n    disabled: disabled,\n    orientation: orientation,\n    options: [],\n    searchQuery: '',\n    activeOptionIndex: null\n  });\n  var _reducerBag$ = reducerBag[0],\n    listboxState = _reducerBag$.listboxState,\n    propsRef = _reducerBag$.propsRef,\n    optionsRef = _reducerBag$.optionsRef,\n    buttonRef = _reducerBag$.buttonRef,\n    dispatch = reducerBag[1];\n  useIsoMorphicEffect(function () {\n    propsRef.current.value = value;\n  }, [value, propsRef]);\n  useIsoMorphicEffect(function () {\n    propsRef.current.onChange = onChange;\n  }, [onChange, propsRef]);\n  useIsoMorphicEffect(function () {\n    return dispatch({\n      type: ActionTypes.SetDisabled,\n      disabled: disabled\n    });\n  }, [disabled]);\n  useIsoMorphicEffect(function () {\n    return dispatch({\n      type: ActionTypes.SetOrientation,\n      orientation: orientation\n    });\n  }, [orientation]); // Handle outside click\n\n  useWindowEvent('mousedown', function (event) {\n    var _buttonRef$current, _optionsRef$current;\n    var target = event.target;\n    if (listboxState !== ListboxStates.Open) return;\n    if ((_buttonRef$current = buttonRef.current) == null ? void 0 : _buttonRef$current.contains(target)) return;\n    if ((_optionsRef$current = optionsRef.current) == null ? void 0 : _optionsRef$current.contains(target)) return;\n    dispatch({\n      type: ActionTypes.CloseListbox\n    });\n    if (!isFocusableElement(target, FocusableMode.Loose)) {\n      var _buttonRef$current2;\n      event.preventDefault();\n      (_buttonRef$current2 = buttonRef.current) == null ? void 0 : _buttonRef$current2.focus();\n    }\n  });\n  var slot = useMemo(function () {\n    return {\n      open: listboxState === ListboxStates.Open,\n      disabled: disabled\n    };\n  }, [listboxState, disabled]);\n  return React.createElement(ListboxContext.Provider, {\n    value: reducerBag\n  }, React.createElement(OpenClosedProvider, {\n    value: match(listboxState, (_match = {}, _match[ListboxStates.Open] = State.Open, _match[ListboxStates.Closed] = State.Closed, _match))\n  }, render({\n    props: passThroughProps,\n    slot: slot,\n    defaultTag: DEFAULT_LISTBOX_TAG,\n    name: 'Listbox'\n  })));\n} // ---\n\nvar DEFAULT_BUTTON_TAG = 'button';\nvar Button = /*#__PURE__*/forwardRefWithAs(function Button(props, ref) {\n  var _state$optionsRef$cur;\n  var _useListboxContext = useListboxContext([Listbox.name, Button.name].join('.')),\n    state = _useListboxContext[0],\n    dispatch = _useListboxContext[1];\n  var buttonRef = useSyncRefs(state.buttonRef, ref);\n  var id = \"headlessui-listbox-button-\" + useId();\n  var d = useDisposables();\n  var handleKeyDown = useCallback(function (event) {\n    switch (event.key) {\n      // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n      case Keys.Space:\n      case Keys.Enter:\n      case Keys.ArrowDown:\n        event.preventDefault();\n        dispatch({\n          type: ActionTypes.OpenListbox\n        });\n        d.nextFrame(function () {\n          if (!state.propsRef.current.value) dispatch({\n            type: ActionTypes.GoToOption,\n            focus: Focus.First\n          });\n        });\n        break;\n      case Keys.ArrowUp:\n        event.preventDefault();\n        dispatch({\n          type: ActionTypes.OpenListbox\n        });\n        d.nextFrame(function () {\n          if (!state.propsRef.current.value) dispatch({\n            type: ActionTypes.GoToOption,\n            focus: Focus.Last\n          });\n        });\n        break;\n    }\n  }, [dispatch, state, d]);\n  var handleKeyUp = useCallback(function (event) {\n    switch (event.key) {\n      case Keys.Space:\n        // Required for firefox, event.preventDefault() in handleKeyDown for\n        // the Space key doesn't cancel the handleKeyUp, which in turn\n        // triggers a *click*.\n        event.preventDefault();\n        break;\n    }\n  }, []);\n  var handleClick = useCallback(function (event) {\n    if (isDisabledReactIssue7711(event.currentTarget)) return event.preventDefault();\n    if (state.listboxState === ListboxStates.Open) {\n      dispatch({\n        type: ActionTypes.CloseListbox\n      });\n      d.nextFrame(function () {\n        var _state$buttonRef$curr;\n        return (_state$buttonRef$curr = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr.focus({\n          preventScroll: true\n        });\n      });\n    } else {\n      event.preventDefault();\n      dispatch({\n        type: ActionTypes.OpenListbox\n      });\n    }\n  }, [dispatch, d, state]);\n  var labelledby = useComputed(function () {\n    if (!state.labelRef.current) return undefined;\n    return [state.labelRef.current.id, id].join(' ');\n  }, [state.labelRef.current, id]);\n  var slot = useMemo(function () {\n    return {\n      open: state.listboxState === ListboxStates.Open,\n      disabled: state.disabled\n    };\n  }, [state]);\n  var passthroughProps = props;\n  var propsWeControl = {\n    ref: buttonRef,\n    id: id,\n    type: useResolveButtonType(props, state.buttonRef),\n    'aria-haspopup': true,\n    'aria-controls': (_state$optionsRef$cur = state.optionsRef.current) == null ? void 0 : _state$optionsRef$cur.id,\n    'aria-expanded': state.disabled ? undefined : state.listboxState === ListboxStates.Open,\n    'aria-labelledby': labelledby,\n    disabled: state.disabled,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    onClick: handleClick\n  };\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_BUTTON_TAG,\n    name: 'Listbox.Button'\n  });\n}); // ---\n\nvar DEFAULT_LABEL_TAG = 'label';\nfunction Label(props) {\n  var _useListboxContext2 = useListboxContext([Listbox.name, Label.name].join('.')),\n    state = _useListboxContext2[0];\n  var id = \"headlessui-listbox-label-\" + useId();\n  var handleClick = useCallback(function () {\n    var _state$buttonRef$curr2;\n    return (_state$buttonRef$curr2 = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr2.focus({\n      preventScroll: true\n    });\n  }, [state.buttonRef]);\n  var slot = useMemo(function () {\n    return {\n      open: state.listboxState === ListboxStates.Open,\n      disabled: state.disabled\n    };\n  }, [state]);\n  var propsWeControl = {\n    ref: state.labelRef,\n    id: id,\n    onClick: handleClick\n  };\n  return render({\n    props: _extends({}, props, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_LABEL_TAG,\n    name: 'Listbox.Label'\n  });\n} // ---\n\nvar DEFAULT_OPTIONS_TAG = 'ul';\nvar OptionsRenderFeatures = Features.RenderStrategy | Features.Static;\nvar Options = /*#__PURE__*/forwardRefWithAs(function Options(props, ref) {\n  var _state$options$state$;\n  var _useListboxContext3 = useListboxContext([Listbox.name, Options.name].join('.')),\n    state = _useListboxContext3[0],\n    dispatch = _useListboxContext3[1];\n  var optionsRef = useSyncRefs(state.optionsRef, ref);\n  var id = \"headlessui-listbox-options-\" + useId();\n  var d = useDisposables();\n  var searchDisposables = useDisposables();\n  var usesOpenClosedState = useOpenClosed();\n  var visible = function () {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open;\n    }\n    return state.listboxState === ListboxStates.Open;\n  }();\n  useIsoMorphicEffect(function () {\n    var container = state.optionsRef.current;\n    if (!container) return;\n    if (state.listboxState !== ListboxStates.Open) return;\n    if (container === document.activeElement) return;\n    container.focus({\n      preventScroll: true\n    });\n  }, [state.listboxState, state.optionsRef]);\n  var handleKeyDown = useCallback(function (event) {\n    searchDisposables.dispose();\n    switch (event.key) {\n      // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n      // @ts-expect-error Fallthrough is expected here\n      case Keys.Space:\n        if (state.searchQuery !== '') {\n          event.preventDefault();\n          event.stopPropagation();\n          return dispatch({\n            type: ActionTypes.Search,\n            value: event.key\n          });\n        }\n\n      // When in type ahead mode, fallthrough\n\n      case Keys.Enter:\n        event.preventDefault();\n        event.stopPropagation();\n        dispatch({\n          type: ActionTypes.CloseListbox\n        });\n        if (state.activeOptionIndex !== null) {\n          var dataRef = state.options[state.activeOptionIndex].dataRef;\n          state.propsRef.current.onChange(dataRef.current.value);\n        }\n        disposables().nextFrame(function () {\n          var _state$buttonRef$curr3;\n          return (_state$buttonRef$curr3 = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr3.focus({\n            preventScroll: true\n          });\n        });\n        break;\n      case match(state.orientation, {\n        vertical: Keys.ArrowDown,\n        horizontal: Keys.ArrowRight\n      }):\n        event.preventDefault();\n        event.stopPropagation();\n        return dispatch({\n          type: ActionTypes.GoToOption,\n          focus: Focus.Next\n        });\n      case match(state.orientation, {\n        vertical: Keys.ArrowUp,\n        horizontal: Keys.ArrowLeft\n      }):\n        event.preventDefault();\n        event.stopPropagation();\n        return dispatch({\n          type: ActionTypes.GoToOption,\n          focus: Focus.Previous\n        });\n      case Keys.Home:\n      case Keys.PageUp:\n        event.preventDefault();\n        event.stopPropagation();\n        return dispatch({\n          type: ActionTypes.GoToOption,\n          focus: Focus.First\n        });\n      case Keys.End:\n      case Keys.PageDown:\n        event.preventDefault();\n        event.stopPropagation();\n        return dispatch({\n          type: ActionTypes.GoToOption,\n          focus: Focus.Last\n        });\n      case Keys.Escape:\n        event.preventDefault();\n        event.stopPropagation();\n        dispatch({\n          type: ActionTypes.CloseListbox\n        });\n        return d.nextFrame(function () {\n          var _state$buttonRef$curr4;\n          return (_state$buttonRef$curr4 = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr4.focus({\n            preventScroll: true\n          });\n        });\n      case Keys.Tab:\n        event.preventDefault();\n        event.stopPropagation();\n        break;\n      default:\n        if (event.key.length === 1) {\n          dispatch({\n            type: ActionTypes.Search,\n            value: event.key\n          });\n          searchDisposables.setTimeout(function () {\n            return dispatch({\n              type: ActionTypes.ClearSearch\n            });\n          }, 350);\n        }\n        break;\n    }\n  }, [d, dispatch, searchDisposables, state]);\n  var labelledby = useComputed(function () {\n    var _state$labelRef$curre, _state$labelRef$curre2, _state$buttonRef$curr5;\n    return (_state$labelRef$curre = (_state$labelRef$curre2 = state.labelRef.current) == null ? void 0 : _state$labelRef$curre2.id) != null ? _state$labelRef$curre : (_state$buttonRef$curr5 = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr5.id;\n  }, [state.labelRef.current, state.buttonRef.current]);\n  var slot = useMemo(function () {\n    return {\n      open: state.listboxState === ListboxStates.Open\n    };\n  }, [state]);\n  var propsWeControl = {\n    'aria-activedescendant': state.activeOptionIndex === null ? undefined : (_state$options$state$ = state.options[state.activeOptionIndex]) == null ? void 0 : _state$options$state$.id,\n    'aria-labelledby': labelledby,\n    'aria-orientation': state.orientation,\n    id: id,\n    onKeyDown: handleKeyDown,\n    role: 'listbox',\n    tabIndex: 0,\n    ref: optionsRef\n  };\n  var passthroughProps = props;\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_OPTIONS_TAG,\n    features: OptionsRenderFeatures,\n    visible: visible,\n    name: 'Listbox.Options'\n  });\n}); // ---\n\nvar DEFAULT_OPTION_TAG = 'li';\nfunction Option(props) {\n  var _props$disabled2 = props.disabled,\n    disabled = _props$disabled2 === void 0 ? false : _props$disabled2,\n    value = props.value,\n    passthroughProps = _objectWithoutPropertiesLoose(props, [\"disabled\", \"value\"]);\n  var _useListboxContext4 = useListboxContext([Listbox.name, Option.name].join('.')),\n    state = _useListboxContext4[0],\n    dispatch = _useListboxContext4[1];\n  var id = \"headlessui-listbox-option-\" + useId();\n  var active = state.activeOptionIndex !== null ? state.options[state.activeOptionIndex].id === id : false;\n  var selected = state.propsRef.current.value === value;\n  var bag = useRef({\n    disabled: disabled,\n    value: value\n  });\n  useIsoMorphicEffect(function () {\n    bag.current.disabled = disabled;\n  }, [bag, disabled]);\n  useIsoMorphicEffect(function () {\n    bag.current.value = value;\n  }, [bag, value]);\n  useIsoMorphicEffect(function () {\n    var _document$getElementB, _document$getElementB2;\n    bag.current.textValue = (_document$getElementB = document.getElementById(id)) == null ? void 0 : (_document$getElementB2 = _document$getElementB.textContent) == null ? void 0 : _document$getElementB2.toLowerCase();\n  }, [bag, id]);\n  var select = useCallback(function () {\n    return state.propsRef.current.onChange(value);\n  }, [state.propsRef, value]);\n  useIsoMorphicEffect(function () {\n    dispatch({\n      type: ActionTypes.RegisterOption,\n      id: id,\n      dataRef: bag\n    });\n    return function () {\n      return dispatch({\n        type: ActionTypes.UnregisterOption,\n        id: id\n      });\n    };\n  }, [bag, id]);\n  useIsoMorphicEffect(function () {\n    var _document$getElementB3;\n    if (state.listboxState !== ListboxStates.Open) return;\n    if (!selected) return;\n    dispatch({\n      type: ActionTypes.GoToOption,\n      focus: Focus.Specific,\n      id: id\n    });\n    (_document$getElementB3 = document.getElementById(id)) == null ? void 0 : _document$getElementB3.focus == null ? void 0 : _document$getElementB3.focus();\n  }, [state.listboxState]);\n  useIsoMorphicEffect(function () {\n    if (state.listboxState !== ListboxStates.Open) return;\n    if (!active) return;\n    var d = disposables();\n    d.nextFrame(function () {\n      var _document$getElementB4;\n      return (_document$getElementB4 = document.getElementById(id)) == null ? void 0 : _document$getElementB4.scrollIntoView == null ? void 0 : _document$getElementB4.scrollIntoView({\n        block: 'nearest'\n      });\n    });\n    return d.dispose;\n  }, [id, active, state.listboxState]);\n  var handleClick = useCallback(function (event) {\n    if (disabled) return event.preventDefault();\n    select();\n    dispatch({\n      type: ActionTypes.CloseListbox\n    });\n    disposables().nextFrame(function () {\n      var _state$buttonRef$curr6;\n      return (_state$buttonRef$curr6 = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr6.focus({\n        preventScroll: true\n      });\n    });\n  }, [dispatch, state.buttonRef, disabled, select]);\n  var handleFocus = useCallback(function () {\n    if (disabled) return dispatch({\n      type: ActionTypes.GoToOption,\n      focus: Focus.Nothing\n    });\n    dispatch({\n      type: ActionTypes.GoToOption,\n      focus: Focus.Specific,\n      id: id\n    });\n  }, [disabled, id, dispatch]);\n  var handleMove = useCallback(function () {\n    if (disabled) return;\n    if (active) return;\n    dispatch({\n      type: ActionTypes.GoToOption,\n      focus: Focus.Specific,\n      id: id\n    });\n  }, [disabled, active, id, dispatch]);\n  var handleLeave = useCallback(function () {\n    if (disabled) return;\n    if (!active) return;\n    dispatch({\n      type: ActionTypes.GoToOption,\n      focus: Focus.Nothing\n    });\n  }, [disabled, active, dispatch]);\n  var slot = useMemo(function () {\n    return {\n      active: active,\n      selected: selected,\n      disabled: disabled\n    };\n  }, [active, selected, disabled]);\n  var propsWeControl = {\n    id: id,\n    role: 'option',\n    tabIndex: disabled === true ? undefined : -1,\n    'aria-disabled': disabled === true ? true : undefined,\n    'aria-selected': selected === true ? true : undefined,\n    disabled: undefined,\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handleMove,\n    onMouseMove: handleMove,\n    onPointerLeave: handleLeave,\n    onMouseLeave: handleLeave\n  };\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_OPTION_TAG,\n    name: 'Listbox.Option'\n  });\n} // ---\n\nListbox.Button = Button;\nListbox.Label = Label;\nListbox.Options = Options;\nListbox.Option = Option;\nexport { Listbox };","map":{"version":3,"names":["ListboxStates","ActionTypes","reducers","_reducers","CloseListbox","state","disabled","listboxState","Closed","_extends","activeOptionIndex","OpenListbox","Open","SetDisabled","action","SetOrientation","orientation","GoToOption","calculateActiveIndex","resolveItems","options","resolveActiveIndex","resolveId","item","id","resolveDisabled","dataRef","current","searchQuery","Search","value","toLowerCase","match","findIndex","option","_option$dataRef$curre","textValue","startsWith","ClearSearch","RegisterOption","concat","UnregisterOption","nextOptions","slice","currentActiveOption","idx","a","splice","indexOf","ListboxContext","createContext","displayName","useListboxContext","component","context","useContext","err","Error","Listbox","name","captureStackTrace","stateReducer","type","DEFAULT_LISTBOX_TAG","Fragment","props","onChange","_props$disabled","horizontal","_props$horizontal","passThroughProps","_objectWithoutPropertiesLoose","reducerBag","useReducer","propsRef","labelRef","createRef","buttonRef","optionsRef","_reducerBag$","dispatch","useIsoMorphicEffect","useWindowEvent","event","target","_buttonRef$current","contains","_optionsRef$current","isFocusableElement","FocusableMode","Loose","_buttonRef$current2","preventDefault","focus","slot","useMemo","open","React","createElement","Provider","OpenClosedProvider","_match","State","render","defaultTag","DEFAULT_BUTTON_TAG","Button","forwardRefWithAs","ref","join","_useListboxContext","useSyncRefs","useId","d","useDisposables","handleKeyDown","useCallback","key","Keys","Space","Enter","ArrowDown","nextFrame","Focus","First","ArrowUp","Last","handleKeyUp","handleClick","isDisabledReactIssue7711","currentTarget","_state$buttonRef$curr","preventScroll","labelledby","useComputed","undefined","passthroughProps","propsWeControl","useResolveButtonType","_state$optionsRef$cur","onKeyDown","onKeyUp","onClick","DEFAULT_LABEL_TAG","Label","_useListboxContext2","_state$buttonRef$curr2","DEFAULT_OPTIONS_TAG","OptionsRenderFeatures","Features","RenderStrategy","Static","Options","_useListboxContext3","searchDisposables","usesOpenClosedState","useOpenClosed","visible","container","document","activeElement","dispose","stopPropagation","disposables","_state$buttonRef$curr3","vertical","ArrowRight","Next","ArrowLeft","Previous","Home","PageUp","End","PageDown","Escape","_state$buttonRef$curr4","Tab","length","setTimeout","_state$labelRef$curre","_state$labelRef$curre2","_state$buttonRef$curr5","_state$options$state$","role","tabIndex","features","DEFAULT_OPTION_TAG","Option","_props$disabled2","_useListboxContext4","active","selected","bag","useRef","_document$getElementB","getElementById","_document$getElementB2","textContent","select","Specific","_document$getElementB3","_document$getElementB4","scrollIntoView","block","_state$buttonRef$curr6","handleFocus","Nothing","handleMove","handleLeave","onFocus","onPointerMove","onMouseMove","onPointerLeave","onMouseLeave"],"sources":["/Users/flok/Documents/Check/indexcards.ai/frontend/node_modules/@headlessui/react/src/components/listbox/listbox.tsx"],"sourcesContent":["import React, {\n  Fragment,\n  createContext,\n  createRef,\n  useCallback,\n  useContext,\n  useMemo,\n  useReducer,\n  useRef,\n\n  // Types\n  Dispatch,\n  ElementType,\n  KeyboardEvent as ReactKeyboardEvent,\n  MouseEvent as ReactMouseEvent,\n  MutableRefObject,\n  Ref,\n} from 'react'\n\nimport { useDisposables } from '../../hooks/use-disposables'\nimport { useId } from '../../hooks/use-id'\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect'\nimport { useComputed } from '../../hooks/use-computed'\nimport { useSyncRefs } from '../../hooks/use-sync-refs'\nimport { Props } from '../../types'\nimport { Features, forwardRefWithAs, PropsForFeatures, render } from '../../utils/render'\nimport { match } from '../../utils/match'\nimport { disposables } from '../../utils/disposables'\nimport { Keys } from '../keyboard'\nimport { Focus, calculateActiveIndex } from '../../utils/calculate-active-index'\nimport { isDisabledReactIssue7711 } from '../../utils/bugs'\nimport { isFocusableElement, FocusableMode } from '../../utils/focus-management'\nimport { useWindowEvent } from '../../hooks/use-window-event'\nimport { useOpenClosed, State, OpenClosedProvider } from '../../internal/open-closed'\nimport { useResolveButtonType } from '../../hooks/use-resolve-button-type'\n\nenum ListboxStates {\n  Open,\n  Closed,\n}\n\ntype ListboxOptionDataRef = MutableRefObject<{\n  textValue?: string\n  disabled: boolean\n  value: unknown\n}>\n\ninterface StateDefinition {\n  listboxState: ListboxStates\n\n  orientation: 'horizontal' | 'vertical'\n\n  propsRef: MutableRefObject<{ value: unknown; onChange(value: unknown): void }>\n  labelRef: MutableRefObject<HTMLLabelElement | null>\n  buttonRef: MutableRefObject<HTMLButtonElement | null>\n  optionsRef: MutableRefObject<HTMLUListElement | null>\n\n  disabled: boolean\n  options: { id: string; dataRef: ListboxOptionDataRef }[]\n  searchQuery: string\n  activeOptionIndex: number | null\n}\n\nenum ActionTypes {\n  OpenListbox,\n  CloseListbox,\n\n  SetDisabled,\n  SetOrientation,\n\n  GoToOption,\n  Search,\n  ClearSearch,\n\n  RegisterOption,\n  UnregisterOption,\n}\n\ntype Actions =\n  | { type: ActionTypes.CloseListbox }\n  | { type: ActionTypes.OpenListbox }\n  | { type: ActionTypes.SetDisabled; disabled: boolean }\n  | { type: ActionTypes.SetOrientation; orientation: StateDefinition['orientation'] }\n  | { type: ActionTypes.GoToOption; focus: Focus.Specific; id: string }\n  | { type: ActionTypes.GoToOption; focus: Exclude<Focus, Focus.Specific> }\n  | { type: ActionTypes.Search; value: string }\n  | { type: ActionTypes.ClearSearch }\n  | { type: ActionTypes.RegisterOption; id: string; dataRef: ListboxOptionDataRef }\n  | { type: ActionTypes.UnregisterOption; id: string }\n\nlet reducers: {\n  [P in ActionTypes]: (\n    state: StateDefinition,\n    action: Extract<Actions, { type: P }>\n  ) => StateDefinition\n} = {\n  [ActionTypes.CloseListbox](state) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n    return { ...state, activeOptionIndex: null, listboxState: ListboxStates.Closed }\n  },\n  [ActionTypes.OpenListbox](state) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Open) return state\n    return { ...state, listboxState: ListboxStates.Open }\n  },\n  [ActionTypes.SetDisabled](state, action) {\n    if (state.disabled === action.disabled) return state\n    return { ...state, disabled: action.disabled }\n  },\n  [ActionTypes.SetOrientation](state, action) {\n    if (state.orientation === action.orientation) return state\n    return { ...state, orientation: action.orientation }\n  },\n  [ActionTypes.GoToOption](state, action) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n\n    let activeOptionIndex = calculateActiveIndex(action, {\n      resolveItems: () => state.options,\n      resolveActiveIndex: () => state.activeOptionIndex,\n      resolveId: item => item.id,\n      resolveDisabled: item => item.dataRef.current.disabled,\n    })\n\n    if (state.searchQuery === '' && state.activeOptionIndex === activeOptionIndex) return state\n    return { ...state, searchQuery: '', activeOptionIndex }\n  },\n  [ActionTypes.Search]: (state, action) => {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n\n    let searchQuery = state.searchQuery + action.value.toLowerCase()\n    let match = state.options.findIndex(\n      option =>\n        !option.dataRef.current.disabled &&\n        option.dataRef.current.textValue?.startsWith(searchQuery)\n    )\n\n    if (match === -1 || match === state.activeOptionIndex) return { ...state, searchQuery }\n    return { ...state, searchQuery, activeOptionIndex: match }\n  },\n  [ActionTypes.ClearSearch](state) {\n    if (state.disabled) return state\n    if (state.listboxState === ListboxStates.Closed) return state\n    if (state.searchQuery === '') return state\n    return { ...state, searchQuery: '' }\n  },\n  [ActionTypes.RegisterOption]: (state, action) => ({\n    ...state,\n    options: [...state.options, { id: action.id, dataRef: action.dataRef }],\n  }),\n  [ActionTypes.UnregisterOption]: (state, action) => {\n    let nextOptions = state.options.slice()\n    let currentActiveOption =\n      state.activeOptionIndex !== null ? nextOptions[state.activeOptionIndex] : null\n\n    let idx = nextOptions.findIndex(a => a.id === action.id)\n\n    if (idx !== -1) nextOptions.splice(idx, 1)\n\n    return {\n      ...state,\n      options: nextOptions,\n      activeOptionIndex: (() => {\n        if (idx === state.activeOptionIndex) return null\n        if (currentActiveOption === null) return null\n\n        // If we removed the option before the actual active index, then it would be out of sync. To\n        // fix this, we will find the correct (new) index position.\n        return nextOptions.indexOf(currentActiveOption)\n      })(),\n    }\n  },\n}\n\nlet ListboxContext = createContext<[StateDefinition, Dispatch<Actions>] | null>(null)\nListboxContext.displayName = 'ListboxContext'\n\nfunction useListboxContext(component: string) {\n  let context = useContext(ListboxContext)\n  if (context === null) {\n    let err = new Error(`<${component} /> is missing a parent <${Listbox.name} /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useListboxContext)\n    throw err\n  }\n  return context\n}\n\nfunction stateReducer(state: StateDefinition, action: Actions) {\n  return match(action.type, reducers, state, action)\n}\n\n// ---\n\nlet DEFAULT_LISTBOX_TAG = Fragment\ninterface ListboxRenderPropArg {\n  open: boolean\n  disabled: boolean\n}\n\nexport function Listbox<TTag extends ElementType = typeof DEFAULT_LISTBOX_TAG, TType = string>(\n  props: Props<TTag, ListboxRenderPropArg, 'value' | 'onChange'> & {\n    value: TType\n    onChange(value: TType): void\n    disabled?: boolean\n    horizontal?: boolean\n  }\n) {\n  let { value, onChange, disabled = false, horizontal = false, ...passThroughProps } = props\n  const orientation = horizontal ? 'horizontal' : 'vertical'\n\n  let reducerBag = useReducer(stateReducer, {\n    listboxState: ListboxStates.Closed,\n    propsRef: { current: { value, onChange } },\n    labelRef: createRef(),\n    buttonRef: createRef(),\n    optionsRef: createRef(),\n    disabled,\n    orientation,\n    options: [],\n    searchQuery: '',\n    activeOptionIndex: null,\n  } as StateDefinition)\n  let [{ listboxState, propsRef, optionsRef, buttonRef }, dispatch] = reducerBag\n\n  useIsoMorphicEffect(() => {\n    propsRef.current.value = value\n  }, [value, propsRef])\n  useIsoMorphicEffect(() => {\n    propsRef.current.onChange = onChange\n  }, [onChange, propsRef])\n  useIsoMorphicEffect(() => dispatch({ type: ActionTypes.SetDisabled, disabled }), [disabled])\n  useIsoMorphicEffect(() => dispatch({ type: ActionTypes.SetOrientation, orientation }), [\n    orientation,\n  ])\n\n  // Handle outside click\n  useWindowEvent('mousedown', event => {\n    let target = event.target as HTMLElement\n\n    if (listboxState !== ListboxStates.Open) return\n\n    if (buttonRef.current?.contains(target)) return\n    if (optionsRef.current?.contains(target)) return\n\n    dispatch({ type: ActionTypes.CloseListbox })\n\n    if (!isFocusableElement(target, FocusableMode.Loose)) {\n      event.preventDefault()\n      buttonRef.current?.focus()\n    }\n  })\n\n  let slot = useMemo<ListboxRenderPropArg>(\n    () => ({ open: listboxState === ListboxStates.Open, disabled }),\n    [listboxState, disabled]\n  )\n\n  return (\n    <ListboxContext.Provider value={reducerBag}>\n      <OpenClosedProvider\n        value={match(listboxState, {\n          [ListboxStates.Open]: State.Open,\n          [ListboxStates.Closed]: State.Closed,\n        })}\n      >\n        {render({\n          props: passThroughProps,\n          slot,\n          defaultTag: DEFAULT_LISTBOX_TAG,\n          name: 'Listbox',\n        })}\n      </OpenClosedProvider>\n    </ListboxContext.Provider>\n  )\n}\n\n// ---\n\nlet DEFAULT_BUTTON_TAG = 'button' as const\ninterface ButtonRenderPropArg {\n  open: boolean\n  disabled: boolean\n}\ntype ButtonPropsWeControl =\n  | 'id'\n  | 'type'\n  | 'aria-haspopup'\n  | 'aria-controls'\n  | 'aria-expanded'\n  | 'aria-labelledby'\n  | 'disabled'\n  | 'onKeyDown'\n  | 'onClick'\n\nlet Button = forwardRefWithAs(function Button<TTag extends ElementType = typeof DEFAULT_BUTTON_TAG>(\n  props: Props<TTag, ButtonRenderPropArg, ButtonPropsWeControl>,\n  ref: Ref<HTMLButtonElement>\n) {\n  let [state, dispatch] = useListboxContext([Listbox.name, Button.name].join('.'))\n  let buttonRef = useSyncRefs(state.buttonRef, ref)\n\n  let id = `headlessui-listbox-button-${useId()}`\n  let d = useDisposables()\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLButtonElement>) => {\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n\n        case Keys.Space:\n        case Keys.Enter:\n        case Keys.ArrowDown:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenListbox })\n          d.nextFrame(() => {\n            if (!state.propsRef.current.value)\n              dispatch({ type: ActionTypes.GoToOption, focus: Focus.First })\n          })\n          break\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          dispatch({ type: ActionTypes.OpenListbox })\n          d.nextFrame(() => {\n            if (!state.propsRef.current.value)\n              dispatch({ type: ActionTypes.GoToOption, focus: Focus.Last })\n          })\n          break\n      }\n    },\n    [dispatch, state, d]\n  )\n\n  let handleKeyUp = useCallback((event: ReactKeyboardEvent<HTMLButtonElement>) => {\n    switch (event.key) {\n      case Keys.Space:\n        // Required for firefox, event.preventDefault() in handleKeyDown for\n        // the Space key doesn't cancel the handleKeyUp, which in turn\n        // triggers a *click*.\n        event.preventDefault()\n        break\n    }\n  }, [])\n\n  let handleClick = useCallback(\n    (event: ReactMouseEvent) => {\n      if (isDisabledReactIssue7711(event.currentTarget)) return event.preventDefault()\n      if (state.listboxState === ListboxStates.Open) {\n        dispatch({ type: ActionTypes.CloseListbox })\n        d.nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n      } else {\n        event.preventDefault()\n        dispatch({ type: ActionTypes.OpenListbox })\n      }\n    },\n    [dispatch, d, state]\n  )\n\n  let labelledby = useComputed(() => {\n    if (!state.labelRef.current) return undefined\n    return [state.labelRef.current.id, id].join(' ')\n  }, [state.labelRef.current, id])\n\n  let slot = useMemo<ButtonRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open, disabled: state.disabled }),\n    [state]\n  )\n  let passthroughProps = props\n  let propsWeControl = {\n    ref: buttonRef,\n    id,\n    type: useResolveButtonType(props, state.buttonRef),\n    'aria-haspopup': true,\n    'aria-controls': state.optionsRef.current?.id,\n    'aria-expanded': state.disabled ? undefined : state.listboxState === ListboxStates.Open,\n    'aria-labelledby': labelledby,\n    disabled: state.disabled,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    onClick: handleClick,\n  }\n\n  return render({\n    props: { ...passthroughProps, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_BUTTON_TAG,\n    name: 'Listbox.Button',\n  })\n})\n\n// ---\n\nlet DEFAULT_LABEL_TAG = 'label' as const\ninterface LabelRenderPropArg {\n  open: boolean\n  disabled: boolean\n}\ntype LabelPropsWeControl = 'id' | 'ref' | 'onClick'\n\nfunction Label<TTag extends ElementType = typeof DEFAULT_LABEL_TAG>(\n  props: Props<TTag, LabelRenderPropArg, LabelPropsWeControl>\n) {\n  let [state] = useListboxContext([Listbox.name, Label.name].join('.'))\n  let id = `headlessui-listbox-label-${useId()}`\n\n  let handleClick = useCallback(() => state.buttonRef.current?.focus({ preventScroll: true }), [\n    state.buttonRef,\n  ])\n\n  let slot = useMemo<LabelRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open, disabled: state.disabled }),\n    [state]\n  )\n  let propsWeControl = { ref: state.labelRef, id, onClick: handleClick }\n  return render({\n    props: { ...props, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_LABEL_TAG,\n    name: 'Listbox.Label',\n  })\n}\n\n// ---\n\nlet DEFAULT_OPTIONS_TAG = 'ul' as const\ninterface OptionsRenderPropArg {\n  open: boolean\n}\ntype OptionsPropsWeControl =\n  | 'aria-activedescendant'\n  | 'aria-labelledby'\n  | 'aria-orientation'\n  | 'id'\n  | 'onKeyDown'\n  | 'role'\n  | 'tabIndex'\n\nlet OptionsRenderFeatures = Features.RenderStrategy | Features.Static\n\nlet Options = forwardRefWithAs(function Options<\n  TTag extends ElementType = typeof DEFAULT_OPTIONS_TAG\n>(\n  props: Props<TTag, OptionsRenderPropArg, OptionsPropsWeControl> &\n    PropsForFeatures<typeof OptionsRenderFeatures>,\n  ref: Ref<HTMLUListElement>\n) {\n  let [state, dispatch] = useListboxContext([Listbox.name, Options.name].join('.'))\n  let optionsRef = useSyncRefs(state.optionsRef, ref)\n\n  let id = `headlessui-listbox-options-${useId()}`\n  let d = useDisposables()\n  let searchDisposables = useDisposables()\n\n  let usesOpenClosedState = useOpenClosed()\n  let visible = (() => {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open\n    }\n\n    return state.listboxState === ListboxStates.Open\n  })()\n\n  useIsoMorphicEffect(() => {\n    let container = state.optionsRef.current\n    if (!container) return\n    if (state.listboxState !== ListboxStates.Open) return\n    if (container === document.activeElement) return\n\n    container.focus({ preventScroll: true })\n  }, [state.listboxState, state.optionsRef])\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLUListElement>) => {\n      searchDisposables.dispose()\n\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n\n        // @ts-expect-error Fallthrough is expected here\n        case Keys.Space:\n          if (state.searchQuery !== '') {\n            event.preventDefault()\n            event.stopPropagation()\n            return dispatch({ type: ActionTypes.Search, value: event.key })\n          }\n        // When in type ahead mode, fallthrough\n        case Keys.Enter:\n          event.preventDefault()\n          event.stopPropagation()\n          dispatch({ type: ActionTypes.CloseListbox })\n          if (state.activeOptionIndex !== null) {\n            let { dataRef } = state.options[state.activeOptionIndex]\n            state.propsRef.current.onChange(dataRef.current.value)\n          }\n          disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n          break\n\n        case match(state.orientation, { vertical: Keys.ArrowDown, horizontal: Keys.ArrowRight }):\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Next })\n\n        case match(state.orientation, { vertical: Keys.ArrowUp, horizontal: Keys.ArrowLeft }):\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Previous })\n\n        case Keys.Home:\n        case Keys.PageUp:\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.First })\n\n        case Keys.End:\n        case Keys.PageDown:\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Last })\n\n        case Keys.Escape:\n          event.preventDefault()\n          event.stopPropagation()\n          dispatch({ type: ActionTypes.CloseListbox })\n          return d.nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n\n        case Keys.Tab:\n          event.preventDefault()\n          event.stopPropagation()\n          break\n\n        default:\n          if (event.key.length === 1) {\n            dispatch({ type: ActionTypes.Search, value: event.key })\n            searchDisposables.setTimeout(() => dispatch({ type: ActionTypes.ClearSearch }), 350)\n          }\n          break\n      }\n    },\n    [d, dispatch, searchDisposables, state]\n  )\n\n  let labelledby = useComputed(() => state.labelRef.current?.id ?? state.buttonRef.current?.id, [\n    state.labelRef.current,\n    state.buttonRef.current,\n  ])\n\n  let slot = useMemo<OptionsRenderPropArg>(\n    () => ({ open: state.listboxState === ListboxStates.Open }),\n    [state]\n  )\n  let propsWeControl = {\n    'aria-activedescendant':\n      state.activeOptionIndex === null ? undefined : state.options[state.activeOptionIndex]?.id,\n    'aria-labelledby': labelledby,\n    'aria-orientation': state.orientation,\n    id,\n    onKeyDown: handleKeyDown,\n    role: 'listbox',\n    tabIndex: 0,\n    ref: optionsRef,\n  }\n  let passthroughProps = props\n\n  return render({\n    props: { ...passthroughProps, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_OPTIONS_TAG,\n    features: OptionsRenderFeatures,\n    visible,\n    name: 'Listbox.Options',\n  })\n})\n\n// ---\n\nlet DEFAULT_OPTION_TAG = 'li' as const\ninterface OptionRenderPropArg {\n  active: boolean\n  selected: boolean\n  disabled: boolean\n}\ntype ListboxOptionPropsWeControl =\n  | 'id'\n  | 'role'\n  | 'tabIndex'\n  | 'aria-disabled'\n  | 'aria-selected'\n  | 'onPointerLeave'\n  | 'onMouseLeave'\n  | 'onPointerMove'\n  | 'onMouseMove'\n  | 'onFocus'\n\nfunction Option<\n  TTag extends ElementType = typeof DEFAULT_OPTION_TAG,\n  // TODO: One day we will be able to infer this type from the generic in Listbox itself.\n  // But today is not that day..\n  TType = Parameters<typeof Listbox>[0]['value']\n>(\n  props: Props<TTag, OptionRenderPropArg, ListboxOptionPropsWeControl | 'value'> & {\n    disabled?: boolean\n    value: TType\n  }\n) {\n  let { disabled = false, value, ...passthroughProps } = props\n  let [state, dispatch] = useListboxContext([Listbox.name, Option.name].join('.'))\n  let id = `headlessui-listbox-option-${useId()}`\n  let active =\n    state.activeOptionIndex !== null ? state.options[state.activeOptionIndex].id === id : false\n  let selected = state.propsRef.current.value === value\n\n  let bag = useRef<ListboxOptionDataRef['current']>({ disabled, value })\n\n  useIsoMorphicEffect(() => {\n    bag.current.disabled = disabled\n  }, [bag, disabled])\n  useIsoMorphicEffect(() => {\n    bag.current.value = value\n  }, [bag, value])\n  useIsoMorphicEffect(() => {\n    bag.current.textValue = document.getElementById(id)?.textContent?.toLowerCase()\n  }, [bag, id])\n\n  let select = useCallback(() => state.propsRef.current.onChange(value), [state.propsRef, value])\n\n  useIsoMorphicEffect(() => {\n    dispatch({ type: ActionTypes.RegisterOption, id, dataRef: bag })\n    return () => dispatch({ type: ActionTypes.UnregisterOption, id })\n  }, [bag, id])\n\n  useIsoMorphicEffect(() => {\n    if (state.listboxState !== ListboxStates.Open) return\n    if (!selected) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n    document.getElementById(id)?.focus?.()\n  }, [state.listboxState])\n\n  useIsoMorphicEffect(() => {\n    if (state.listboxState !== ListboxStates.Open) return\n    if (!active) return\n    let d = disposables()\n    d.nextFrame(() => document.getElementById(id)?.scrollIntoView?.({ block: 'nearest' }))\n    return d.dispose\n  }, [id, active, state.listboxState])\n\n  let handleClick = useCallback(\n    (event: { preventDefault: Function }) => {\n      if (disabled) return event.preventDefault()\n      select()\n      dispatch({ type: ActionTypes.CloseListbox })\n      disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n    },\n    [dispatch, state.buttonRef, disabled, select]\n  )\n\n  let handleFocus = useCallback(() => {\n    if (disabled) return dispatch({ type: ActionTypes.GoToOption, focus: Focus.Nothing })\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n  }, [disabled, id, dispatch])\n\n  let handleMove = useCallback(() => {\n    if (disabled) return\n    if (active) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Specific, id })\n  }, [disabled, active, id, dispatch])\n\n  let handleLeave = useCallback(() => {\n    if (disabled) return\n    if (!active) return\n    dispatch({ type: ActionTypes.GoToOption, focus: Focus.Nothing })\n  }, [disabled, active, dispatch])\n\n  let slot = useMemo<OptionRenderPropArg>(() => ({ active, selected, disabled }), [\n    active,\n    selected,\n    disabled,\n  ])\n  let propsWeControl = {\n    id,\n    role: 'option',\n    tabIndex: disabled === true ? undefined : -1,\n    'aria-disabled': disabled === true ? true : undefined,\n    'aria-selected': selected === true ? true : undefined,\n    disabled: undefined, // Never forward the `disabled` prop\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handleMove,\n    onMouseMove: handleMove,\n    onPointerLeave: handleLeave,\n    onMouseLeave: handleLeave,\n  }\n\n  return render({\n    props: { ...passthroughProps, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_OPTION_TAG,\n    name: 'Listbox.Option',\n  })\n}\n\n// ---\n\nListbox.Button = Button\nListbox.Label = Label\nListbox.Options = Options\nListbox.Option = Option\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}