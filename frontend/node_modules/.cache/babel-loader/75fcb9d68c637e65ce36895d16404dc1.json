{"ast":null,"code":"import { extends as _extends, objectWithoutPropertiesLoose as _objectWithoutPropertiesLoose } from '../../_virtual/_rollupPluginBabelHelpers.js';\nimport React, { useReducer, createRef, useMemo, createContext, useCallback, useEffect, useRef, useContext, Fragment } from 'react';\nimport { match } from '../../utils/match.esm.js';\nimport { render, forwardRefWithAs, Features } from '../../utils/render.esm.js';\nimport { useSyncRefs } from '../../hooks/use-sync-refs.esm.js';\nimport { Keys } from '../keyboard.esm.js';\nimport { isDisabledReactIssue7711 } from '../../utils/bugs.esm.js';\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect.esm.js';\nimport { useId } from '../../hooks/use-id.esm.js';\nimport { isFocusableElement, FocusableMode } from '../../utils/focus-management.esm.js';\nimport { useWindowEvent } from '../../hooks/use-window-event.esm.js';\nimport { OpenClosedProvider, State, useOpenClosed } from '../../internal/open-closed.esm.js';\nimport { useResolveButtonType } from '../../hooks/use-resolve-button-type.esm.js';\nimport { disposables } from '../../utils/disposables.esm.js';\nimport { useDisposables } from '../../hooks/use-disposables.esm.js';\nimport { calculateActiveIndex, Focus } from '../../utils/calculate-active-index.esm.js';\nimport { useTreeWalker } from '../../hooks/use-tree-walker.esm.js';\nvar _reducers;\nvar MenuStates;\n(function (MenuStates) {\n  MenuStates[MenuStates[\"Open\"] = 0] = \"Open\";\n  MenuStates[MenuStates[\"Closed\"] = 1] = \"Closed\";\n})(MenuStates || (MenuStates = {}));\nvar ActionTypes;\n(function (ActionTypes) {\n  ActionTypes[ActionTypes[\"OpenMenu\"] = 0] = \"OpenMenu\";\n  ActionTypes[ActionTypes[\"CloseMenu\"] = 1] = \"CloseMenu\";\n  ActionTypes[ActionTypes[\"GoToItem\"] = 2] = \"GoToItem\";\n  ActionTypes[ActionTypes[\"Search\"] = 3] = \"Search\";\n  ActionTypes[ActionTypes[\"ClearSearch\"] = 4] = \"ClearSearch\";\n  ActionTypes[ActionTypes[\"RegisterItem\"] = 5] = \"RegisterItem\";\n  ActionTypes[ActionTypes[\"UnregisterItem\"] = 6] = \"UnregisterItem\";\n})(ActionTypes || (ActionTypes = {}));\nvar reducers = (_reducers = {}, _reducers[ActionTypes.CloseMenu] = function (state) {\n  if (state.menuState === MenuStates.Closed) return state;\n  return _extends({}, state, {\n    activeItemIndex: null,\n    menuState: MenuStates.Closed\n  });\n}, _reducers[ActionTypes.OpenMenu] = function (state) {\n  if (state.menuState === MenuStates.Open) return state;\n  return _extends({}, state, {\n    menuState: MenuStates.Open\n  });\n}, _reducers[ActionTypes.GoToItem] = function (state, action) {\n  var activeItemIndex = calculateActiveIndex(action, {\n    resolveItems: function resolveItems() {\n      return state.items;\n    },\n    resolveActiveIndex: function resolveActiveIndex() {\n      return state.activeItemIndex;\n    },\n    resolveId: function resolveId(item) {\n      return item.id;\n    },\n    resolveDisabled: function resolveDisabled(item) {\n      return item.dataRef.current.disabled;\n    }\n  });\n  if (state.searchQuery === '' && state.activeItemIndex === activeItemIndex) return state;\n  return _extends({}, state, {\n    searchQuery: '',\n    activeItemIndex: activeItemIndex\n  });\n}, _reducers[ActionTypes.Search] = function (state, action) {\n  var searchQuery = state.searchQuery + action.value.toLowerCase();\n  var match = state.items.findIndex(function (item) {\n    var _item$dataRef$current;\n    return ((_item$dataRef$current = item.dataRef.current.textValue) == null ? void 0 : _item$dataRef$current.startsWith(searchQuery)) && !item.dataRef.current.disabled;\n  });\n  if (match === -1 || match === state.activeItemIndex) return _extends({}, state, {\n    searchQuery: searchQuery\n  });\n  return _extends({}, state, {\n    searchQuery: searchQuery,\n    activeItemIndex: match\n  });\n}, _reducers[ActionTypes.ClearSearch] = function (state) {\n  if (state.searchQuery === '') return state;\n  return _extends({}, state, {\n    searchQuery: ''\n  });\n}, _reducers[ActionTypes.RegisterItem] = function (state, action) {\n  return _extends({}, state, {\n    items: [].concat(state.items, [{\n      id: action.id,\n      dataRef: action.dataRef\n    }])\n  });\n}, _reducers[ActionTypes.UnregisterItem] = function (state, action) {\n  var nextItems = state.items.slice();\n  var currentActiveItem = state.activeItemIndex !== null ? nextItems[state.activeItemIndex] : null;\n  var idx = nextItems.findIndex(function (a) {\n    return a.id === action.id;\n  });\n  if (idx !== -1) nextItems.splice(idx, 1);\n  return _extends({}, state, {\n    items: nextItems,\n    activeItemIndex: function () {\n      if (idx === state.activeItemIndex) return null;\n      if (currentActiveItem === null) return null; // If we removed the item before the actual active index, then it would be out of sync. To\n      // fix this, we will find the correct (new) index position.\n\n      return nextItems.indexOf(currentActiveItem);\n    }()\n  });\n}, _reducers);\nvar MenuContext = /*#__PURE__*/createContext(null);\nMenuContext.displayName = 'MenuContext';\nfunction useMenuContext(component) {\n  var context = useContext(MenuContext);\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <\" + Menu.name + \" /> component.\");\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useMenuContext);\n    throw err;\n  }\n  return context;\n}\nfunction stateReducer(state, action) {\n  return match(action.type, reducers, state, action);\n} // ---\n\nvar DEFAULT_MENU_TAG = Fragment;\nfunction Menu(props) {\n  var _match;\n  var reducerBag = useReducer(stateReducer, {\n    menuState: MenuStates.Closed,\n    buttonRef: createRef(),\n    itemsRef: createRef(),\n    items: [],\n    searchQuery: '',\n    activeItemIndex: null\n  });\n  var _reducerBag$ = reducerBag[0],\n    menuState = _reducerBag$.menuState,\n    itemsRef = _reducerBag$.itemsRef,\n    buttonRef = _reducerBag$.buttonRef,\n    dispatch = reducerBag[1]; // Handle outside click\n\n  useWindowEvent('mousedown', function (event) {\n    var _buttonRef$current, _itemsRef$current;\n    var target = event.target;\n    if (menuState !== MenuStates.Open) return;\n    if ((_buttonRef$current = buttonRef.current) == null ? void 0 : _buttonRef$current.contains(target)) return;\n    if ((_itemsRef$current = itemsRef.current) == null ? void 0 : _itemsRef$current.contains(target)) return;\n    dispatch({\n      type: ActionTypes.CloseMenu\n    });\n    if (!isFocusableElement(target, FocusableMode.Loose)) {\n      var _buttonRef$current2;\n      event.preventDefault();\n      (_buttonRef$current2 = buttonRef.current) == null ? void 0 : _buttonRef$current2.focus();\n    }\n  });\n  var slot = useMemo(function () {\n    return {\n      open: menuState === MenuStates.Open\n    };\n  }, [menuState]);\n  return React.createElement(MenuContext.Provider, {\n    value: reducerBag\n  }, React.createElement(OpenClosedProvider, {\n    value: match(menuState, (_match = {}, _match[MenuStates.Open] = State.Open, _match[MenuStates.Closed] = State.Closed, _match))\n  }, render({\n    props: props,\n    slot: slot,\n    defaultTag: DEFAULT_MENU_TAG,\n    name: 'Menu'\n  })));\n} // ---\n\nvar DEFAULT_BUTTON_TAG = 'button';\nvar Button = /*#__PURE__*/forwardRefWithAs(function Button(props, ref) {\n  var _state$itemsRef$curre;\n  var _useMenuContext = useMenuContext([Menu.name, Button.name].join('.')),\n    state = _useMenuContext[0],\n    dispatch = _useMenuContext[1];\n  var buttonRef = useSyncRefs(state.buttonRef, ref);\n  var id = \"headlessui-menu-button-\" + useId();\n  var d = useDisposables();\n  var handleKeyDown = useCallback(function (event) {\n    switch (event.key) {\n      // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n      case Keys.Space:\n      case Keys.Enter:\n      case Keys.ArrowDown:\n        event.preventDefault();\n        event.stopPropagation();\n        dispatch({\n          type: ActionTypes.OpenMenu\n        });\n        d.nextFrame(function () {\n          return dispatch({\n            type: ActionTypes.GoToItem,\n            focus: Focus.First\n          });\n        });\n        break;\n      case Keys.ArrowUp:\n        event.preventDefault();\n        event.stopPropagation();\n        dispatch({\n          type: ActionTypes.OpenMenu\n        });\n        d.nextFrame(function () {\n          return dispatch({\n            type: ActionTypes.GoToItem,\n            focus: Focus.Last\n          });\n        });\n        break;\n    }\n  }, [dispatch, d]);\n  var handleKeyUp = useCallback(function (event) {\n    switch (event.key) {\n      case Keys.Space:\n        // Required for firefox, event.preventDefault() in handleKeyDown for\n        // the Space key doesn't cancel the handleKeyUp, which in turn\n        // triggers a *click*.\n        event.preventDefault();\n        break;\n    }\n  }, []);\n  var handleClick = useCallback(function (event) {\n    if (isDisabledReactIssue7711(event.currentTarget)) return event.preventDefault();\n    if (props.disabled) return;\n    if (state.menuState === MenuStates.Open) {\n      dispatch({\n        type: ActionTypes.CloseMenu\n      });\n      d.nextFrame(function () {\n        var _state$buttonRef$curr;\n        return (_state$buttonRef$curr = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr.focus({\n          preventScroll: true\n        });\n      });\n    } else {\n      event.preventDefault();\n      event.stopPropagation();\n      dispatch({\n        type: ActionTypes.OpenMenu\n      });\n    }\n  }, [dispatch, d, state, props.disabled]);\n  var slot = useMemo(function () {\n    return {\n      open: state.menuState === MenuStates.Open\n    };\n  }, [state]);\n  var passthroughProps = props;\n  var propsWeControl = {\n    ref: buttonRef,\n    id: id,\n    type: useResolveButtonType(props, state.buttonRef),\n    'aria-haspopup': true,\n    'aria-controls': (_state$itemsRef$curre = state.itemsRef.current) == null ? void 0 : _state$itemsRef$curre.id,\n    'aria-expanded': props.disabled ? undefined : state.menuState === MenuStates.Open,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    onClick: handleClick\n  };\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_BUTTON_TAG,\n    name: 'Menu.Button'\n  });\n}); // ---\n\nvar DEFAULT_ITEMS_TAG = 'div';\nvar ItemsRenderFeatures = Features.RenderStrategy | Features.Static;\nvar Items = /*#__PURE__*/forwardRefWithAs(function Items(props, ref) {\n  var _state$items$state$ac, _state$buttonRef$curr4;\n  var _useMenuContext2 = useMenuContext([Menu.name, Items.name].join('.')),\n    state = _useMenuContext2[0],\n    dispatch = _useMenuContext2[1];\n  var itemsRef = useSyncRefs(state.itemsRef, ref);\n  var id = \"headlessui-menu-items-\" + useId();\n  var searchDisposables = useDisposables();\n  var usesOpenClosedState = useOpenClosed();\n  var visible = function () {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open;\n    }\n    return state.menuState === MenuStates.Open;\n  }();\n  useEffect(function () {\n    var container = state.itemsRef.current;\n    if (!container) return;\n    if (state.menuState !== MenuStates.Open) return;\n    if (container === document.activeElement) return;\n    container.focus({\n      preventScroll: true\n    });\n  }, [state.menuState, state.itemsRef]);\n  useTreeWalker({\n    container: state.itemsRef.current,\n    enabled: state.menuState === MenuStates.Open,\n    accept: function accept(node) {\n      if (node.getAttribute('role') === 'menuitem') return NodeFilter.FILTER_REJECT;\n      if (node.hasAttribute('role')) return NodeFilter.FILTER_SKIP;\n      return NodeFilter.FILTER_ACCEPT;\n    },\n    walk: function walk(node) {\n      node.setAttribute('role', 'none');\n    }\n  });\n  var handleKeyDown = useCallback(function (event) {\n    searchDisposables.dispose();\n    switch (event.key) {\n      // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n      // @ts-expect-error Fallthrough is expected here\n      case Keys.Space:\n        if (state.searchQuery !== '') {\n          event.preventDefault();\n          event.stopPropagation();\n          return dispatch({\n            type: ActionTypes.Search,\n            value: event.key\n          });\n        }\n\n      // When in type ahead mode, fallthrough\n\n      case Keys.Enter:\n        event.preventDefault();\n        event.stopPropagation();\n        dispatch({\n          type: ActionTypes.CloseMenu\n        });\n        if (state.activeItemIndex !== null) {\n          var _document$getElementB;\n          var _id = state.items[state.activeItemIndex].id;\n          (_document$getElementB = document.getElementById(_id)) == null ? void 0 : _document$getElementB.click();\n        }\n        disposables().nextFrame(function () {\n          var _state$buttonRef$curr2;\n          return (_state$buttonRef$curr2 = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr2.focus({\n            preventScroll: true\n          });\n        });\n        break;\n      case Keys.ArrowDown:\n        event.preventDefault();\n        event.stopPropagation();\n        return dispatch({\n          type: ActionTypes.GoToItem,\n          focus: Focus.Next\n        });\n      case Keys.ArrowUp:\n        event.preventDefault();\n        event.stopPropagation();\n        return dispatch({\n          type: ActionTypes.GoToItem,\n          focus: Focus.Previous\n        });\n      case Keys.Home:\n      case Keys.PageUp:\n        event.preventDefault();\n        event.stopPropagation();\n        return dispatch({\n          type: ActionTypes.GoToItem,\n          focus: Focus.First\n        });\n      case Keys.End:\n      case Keys.PageDown:\n        event.preventDefault();\n        event.stopPropagation();\n        return dispatch({\n          type: ActionTypes.GoToItem,\n          focus: Focus.Last\n        });\n      case Keys.Escape:\n        event.preventDefault();\n        event.stopPropagation();\n        dispatch({\n          type: ActionTypes.CloseMenu\n        });\n        disposables().nextFrame(function () {\n          var _state$buttonRef$curr3;\n          return (_state$buttonRef$curr3 = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr3.focus({\n            preventScroll: true\n          });\n        });\n        break;\n      case Keys.Tab:\n        event.preventDefault();\n        event.stopPropagation();\n        break;\n      default:\n        if (event.key.length === 1) {\n          dispatch({\n            type: ActionTypes.Search,\n            value: event.key\n          });\n          searchDisposables.setTimeout(function () {\n            return dispatch({\n              type: ActionTypes.ClearSearch\n            });\n          }, 350);\n        }\n        break;\n    }\n  }, [dispatch, searchDisposables, state]);\n  var handleKeyUp = useCallback(function (event) {\n    switch (event.key) {\n      case Keys.Space:\n        // Required for firefox, event.preventDefault() in handleKeyDown for\n        // the Space key doesn't cancel the handleKeyUp, which in turn\n        // triggers a *click*.\n        event.preventDefault();\n        break;\n    }\n  }, []);\n  var slot = useMemo(function () {\n    return {\n      open: state.menuState === MenuStates.Open\n    };\n  }, [state]);\n  var propsWeControl = {\n    'aria-activedescendant': state.activeItemIndex === null ? undefined : (_state$items$state$ac = state.items[state.activeItemIndex]) == null ? void 0 : _state$items$state$ac.id,\n    'aria-labelledby': (_state$buttonRef$curr4 = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr4.id,\n    id: id,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    role: 'menu',\n    tabIndex: 0,\n    ref: itemsRef\n  };\n  var passthroughProps = props;\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_ITEMS_TAG,\n    features: ItemsRenderFeatures,\n    visible: visible,\n    name: 'Menu.Items'\n  });\n}); // ---\n\nvar DEFAULT_ITEM_TAG = Fragment;\nfunction Item(props) {\n  var _props$disabled = props.disabled,\n    disabled = _props$disabled === void 0 ? false : _props$disabled,\n    onClick = props.onClick,\n    passthroughProps = _objectWithoutPropertiesLoose(props, [\"disabled\", \"onClick\"]);\n  var _useMenuContext3 = useMenuContext([Menu.name, Item.name].join('.')),\n    state = _useMenuContext3[0],\n    dispatch = _useMenuContext3[1];\n  var id = \"headlessui-menu-item-\" + useId();\n  var active = state.activeItemIndex !== null ? state.items[state.activeItemIndex].id === id : false;\n  useIsoMorphicEffect(function () {\n    if (state.menuState !== MenuStates.Open) return;\n    if (!active) return;\n    var d = disposables();\n    d.nextFrame(function () {\n      var _document$getElementB2;\n      return (_document$getElementB2 = document.getElementById(id)) == null ? void 0 : _document$getElementB2.scrollIntoView == null ? void 0 : _document$getElementB2.scrollIntoView({\n        block: 'nearest'\n      });\n    });\n    return d.dispose;\n  }, [id, active, state.menuState]);\n  var bag = useRef({\n    disabled: disabled\n  });\n  useIsoMorphicEffect(function () {\n    bag.current.disabled = disabled;\n  }, [bag, disabled]);\n  useIsoMorphicEffect(function () {\n    var _document$getElementB3, _document$getElementB4;\n    bag.current.textValue = (_document$getElementB3 = document.getElementById(id)) == null ? void 0 : (_document$getElementB4 = _document$getElementB3.textContent) == null ? void 0 : _document$getElementB4.toLowerCase();\n  }, [bag, id]);\n  useIsoMorphicEffect(function () {\n    dispatch({\n      type: ActionTypes.RegisterItem,\n      id: id,\n      dataRef: bag\n    });\n    return function () {\n      return dispatch({\n        type: ActionTypes.UnregisterItem,\n        id: id\n      });\n    };\n  }, [bag, id]);\n  var handleClick = useCallback(function (event) {\n    if (disabled) return event.preventDefault();\n    dispatch({\n      type: ActionTypes.CloseMenu\n    });\n    disposables().nextFrame(function () {\n      var _state$buttonRef$curr5;\n      return (_state$buttonRef$curr5 = state.buttonRef.current) == null ? void 0 : _state$buttonRef$curr5.focus({\n        preventScroll: true\n      });\n    });\n    if (onClick) return onClick(event);\n  }, [dispatch, state.buttonRef, disabled, onClick]);\n  var handleFocus = useCallback(function () {\n    if (disabled) return dispatch({\n      type: ActionTypes.GoToItem,\n      focus: Focus.Nothing\n    });\n    dispatch({\n      type: ActionTypes.GoToItem,\n      focus: Focus.Specific,\n      id: id\n    });\n  }, [disabled, id, dispatch]);\n  var handleMove = useCallback(function () {\n    if (disabled) return;\n    if (active) return;\n    dispatch({\n      type: ActionTypes.GoToItem,\n      focus: Focus.Specific,\n      id: id\n    });\n  }, [disabled, active, id, dispatch]);\n  var handleLeave = useCallback(function () {\n    if (disabled) return;\n    if (!active) return;\n    dispatch({\n      type: ActionTypes.GoToItem,\n      focus: Focus.Nothing\n    });\n  }, [disabled, active, dispatch]);\n  var slot = useMemo(function () {\n    return {\n      active: active,\n      disabled: disabled\n    };\n  }, [active, disabled]);\n  var propsWeControl = {\n    id: id,\n    role: 'menuitem',\n    tabIndex: disabled === true ? undefined : -1,\n    'aria-disabled': disabled === true ? true : undefined,\n    disabled: undefined,\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handleMove,\n    onMouseMove: handleMove,\n    onPointerLeave: handleLeave,\n    onMouseLeave: handleLeave\n  };\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_ITEM_TAG,\n    name: 'Menu.Item'\n  });\n} // ---\n\nMenu.Button = Button;\nMenu.Items = Items;\nMenu.Item = Item;\nexport { Menu };","map":{"version":3,"names":["MenuStates","ActionTypes","reducers","_reducers","CloseMenu","state","menuState","Closed","_extends","activeItemIndex","OpenMenu","Open","GoToItem","action","calculateActiveIndex","resolveItems","items","resolveActiveIndex","resolveId","item","id","resolveDisabled","dataRef","current","disabled","searchQuery","Search","value","toLowerCase","match","findIndex","_item$dataRef$current","textValue","startsWith","ClearSearch","RegisterItem","concat","UnregisterItem","nextItems","slice","currentActiveItem","idx","a","splice","indexOf","MenuContext","createContext","displayName","useMenuContext","component","context","useContext","err","Error","Menu","name","captureStackTrace","stateReducer","type","DEFAULT_MENU_TAG","Fragment","props","reducerBag","useReducer","buttonRef","createRef","itemsRef","_reducerBag$","dispatch","useWindowEvent","event","target","_buttonRef$current","contains","_itemsRef$current","isFocusableElement","FocusableMode","Loose","_buttonRef$current2","preventDefault","focus","slot","useMemo","open","React","createElement","Provider","OpenClosedProvider","_match","State","render","defaultTag","DEFAULT_BUTTON_TAG","Button","forwardRefWithAs","ref","join","_useMenuContext","useSyncRefs","useId","d","useDisposables","handleKeyDown","useCallback","key","Keys","Space","Enter","ArrowDown","stopPropagation","nextFrame","Focus","First","ArrowUp","Last","handleKeyUp","handleClick","isDisabledReactIssue7711","currentTarget","_state$buttonRef$curr","preventScroll","passthroughProps","propsWeControl","useResolveButtonType","_state$itemsRef$curre","undefined","onKeyDown","onKeyUp","onClick","DEFAULT_ITEMS_TAG","ItemsRenderFeatures","Features","RenderStrategy","Static","Items","_useMenuContext2","searchDisposables","usesOpenClosedState","useOpenClosed","visible","useEffect","container","document","activeElement","useTreeWalker","enabled","accept","node","getAttribute","NodeFilter","FILTER_REJECT","hasAttribute","FILTER_SKIP","FILTER_ACCEPT","walk","setAttribute","dispose","_document$getElementB","_id","getElementById","click","disposables","_state$buttonRef$curr2","Next","Previous","Home","PageUp","End","PageDown","Escape","_state$buttonRef$curr3","Tab","length","setTimeout","_state$items$state$ac","_state$buttonRef$curr4","role","tabIndex","features","DEFAULT_ITEM_TAG","Item","_props$disabled","_objectWithoutPropertiesLoose","_useMenuContext3","active","useIsoMorphicEffect","_document$getElementB2","scrollIntoView","block","bag","useRef","_document$getElementB3","_document$getElementB4","textContent","_state$buttonRef$curr5","handleFocus","Nothing","Specific","handleMove","handleLeave","onFocus","onPointerMove","onMouseMove","onPointerLeave","onMouseLeave"],"sources":["/Users/flok/Documents/Check/indexcards.ai/frontend/node_modules/@headlessui/react/src/components/menu/menu.tsx"],"sourcesContent":["// WAI-ARIA: https://www.w3.org/TR/wai-aria-practices-1.2/#menubutton\nimport React, {\n  Fragment,\n  createContext,\n  createRef,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n\n  // Types\n  Dispatch,\n  ElementType,\n  KeyboardEvent as ReactKeyboardEvent,\n  MouseEvent as ReactMouseEvent,\n  MutableRefObject,\n  Ref,\n} from 'react'\n\nimport { Props } from '../../types'\nimport { match } from '../../utils/match'\nimport { forwardRefWithAs, render, Features, PropsForFeatures } from '../../utils/render'\nimport { disposables } from '../../utils/disposables'\nimport { useDisposables } from '../../hooks/use-disposables'\nimport { useIsoMorphicEffect } from '../../hooks/use-iso-morphic-effect'\nimport { useSyncRefs } from '../../hooks/use-sync-refs'\nimport { useId } from '../../hooks/use-id'\nimport { Keys } from '../keyboard'\nimport { Focus, calculateActiveIndex } from '../../utils/calculate-active-index'\nimport { isDisabledReactIssue7711 } from '../../utils/bugs'\nimport { isFocusableElement, FocusableMode } from '../../utils/focus-management'\nimport { useWindowEvent } from '../../hooks/use-window-event'\nimport { useTreeWalker } from '../../hooks/use-tree-walker'\nimport { useOpenClosed, State, OpenClosedProvider } from '../../internal/open-closed'\nimport { useResolveButtonType } from '../../hooks/use-resolve-button-type'\n\nenum MenuStates {\n  Open,\n  Closed,\n}\n\ntype MenuItemDataRef = MutableRefObject<{ textValue?: string; disabled: boolean }>\n\ninterface StateDefinition {\n  menuState: MenuStates\n  buttonRef: MutableRefObject<HTMLButtonElement | null>\n  itemsRef: MutableRefObject<HTMLDivElement | null>\n  items: { id: string; dataRef: MenuItemDataRef }[]\n  searchQuery: string\n  activeItemIndex: number | null\n}\n\nenum ActionTypes {\n  OpenMenu,\n  CloseMenu,\n\n  GoToItem,\n  Search,\n  ClearSearch,\n  RegisterItem,\n  UnregisterItem,\n}\n\ntype Actions =\n  | { type: ActionTypes.CloseMenu }\n  | { type: ActionTypes.OpenMenu }\n  | { type: ActionTypes.GoToItem; focus: Focus.Specific; id: string }\n  | { type: ActionTypes.GoToItem; focus: Exclude<Focus, Focus.Specific> }\n  | { type: ActionTypes.Search; value: string }\n  | { type: ActionTypes.ClearSearch }\n  | { type: ActionTypes.RegisterItem; id: string; dataRef: MenuItemDataRef }\n  | { type: ActionTypes.UnregisterItem; id: string }\n\nlet reducers: {\n  [P in ActionTypes]: (\n    state: StateDefinition,\n    action: Extract<Actions, { type: P }>\n  ) => StateDefinition\n} = {\n  [ActionTypes.CloseMenu](state) {\n    if (state.menuState === MenuStates.Closed) return state\n    return { ...state, activeItemIndex: null, menuState: MenuStates.Closed }\n  },\n  [ActionTypes.OpenMenu](state) {\n    if (state.menuState === MenuStates.Open) return state\n    return { ...state, menuState: MenuStates.Open }\n  },\n  [ActionTypes.GoToItem]: (state, action) => {\n    let activeItemIndex = calculateActiveIndex(action, {\n      resolveItems: () => state.items,\n      resolveActiveIndex: () => state.activeItemIndex,\n      resolveId: item => item.id,\n      resolveDisabled: item => item.dataRef.current.disabled,\n    })\n\n    if (state.searchQuery === '' && state.activeItemIndex === activeItemIndex) return state\n    return { ...state, searchQuery: '', activeItemIndex }\n  },\n  [ActionTypes.Search]: (state, action) => {\n    let searchQuery = state.searchQuery + action.value.toLowerCase()\n    let match = state.items.findIndex(\n      item =>\n        item.dataRef.current.textValue?.startsWith(searchQuery) && !item.dataRef.current.disabled\n    )\n\n    if (match === -1 || match === state.activeItemIndex) return { ...state, searchQuery }\n    return { ...state, searchQuery, activeItemIndex: match }\n  },\n  [ActionTypes.ClearSearch](state) {\n    if (state.searchQuery === '') return state\n    return { ...state, searchQuery: '' }\n  },\n  [ActionTypes.RegisterItem]: (state, action) => ({\n    ...state,\n    items: [...state.items, { id: action.id, dataRef: action.dataRef }],\n  }),\n  [ActionTypes.UnregisterItem]: (state, action) => {\n    let nextItems = state.items.slice()\n    let currentActiveItem = state.activeItemIndex !== null ? nextItems[state.activeItemIndex] : null\n\n    let idx = nextItems.findIndex(a => a.id === action.id)\n\n    if (idx !== -1) nextItems.splice(idx, 1)\n\n    return {\n      ...state,\n      items: nextItems,\n      activeItemIndex: (() => {\n        if (idx === state.activeItemIndex) return null\n        if (currentActiveItem === null) return null\n\n        // If we removed the item before the actual active index, then it would be out of sync. To\n        // fix this, we will find the correct (new) index position.\n        return nextItems.indexOf(currentActiveItem)\n      })(),\n    }\n  },\n}\n\nlet MenuContext = createContext<[StateDefinition, Dispatch<Actions>] | null>(null)\nMenuContext.displayName = 'MenuContext'\n\nfunction useMenuContext(component: string) {\n  let context = useContext(MenuContext)\n  if (context === null) {\n    let err = new Error(`<${component} /> is missing a parent <${Menu.name} /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useMenuContext)\n    throw err\n  }\n  return context\n}\n\nfunction stateReducer(state: StateDefinition, action: Actions) {\n  return match(action.type, reducers, state, action)\n}\n\n// ---\n\nlet DEFAULT_MENU_TAG = Fragment\ninterface MenuRenderPropArg {\n  open: boolean\n}\n\nexport function Menu<TTag extends ElementType = typeof DEFAULT_MENU_TAG>(\n  props: Props<TTag, MenuRenderPropArg>\n) {\n  let reducerBag = useReducer(stateReducer, {\n    menuState: MenuStates.Closed,\n    buttonRef: createRef(),\n    itemsRef: createRef(),\n    items: [],\n    searchQuery: '',\n    activeItemIndex: null,\n  } as StateDefinition)\n  let [{ menuState, itemsRef, buttonRef }, dispatch] = reducerBag\n\n  // Handle outside click\n  useWindowEvent('mousedown', event => {\n    let target = event.target as HTMLElement\n\n    if (menuState !== MenuStates.Open) return\n\n    if (buttonRef.current?.contains(target)) return\n    if (itemsRef.current?.contains(target)) return\n\n    dispatch({ type: ActionTypes.CloseMenu })\n\n    if (!isFocusableElement(target, FocusableMode.Loose)) {\n      event.preventDefault()\n      buttonRef.current?.focus()\n    }\n  })\n\n  let slot = useMemo<MenuRenderPropArg>(() => ({ open: menuState === MenuStates.Open }), [\n    menuState,\n  ])\n\n  return (\n    <MenuContext.Provider value={reducerBag}>\n      <OpenClosedProvider\n        value={match(menuState, {\n          [MenuStates.Open]: State.Open,\n          [MenuStates.Closed]: State.Closed,\n        })}\n      >\n        {render({ props, slot, defaultTag: DEFAULT_MENU_TAG, name: 'Menu' })}\n      </OpenClosedProvider>\n    </MenuContext.Provider>\n  )\n}\n\n// ---\n\nlet DEFAULT_BUTTON_TAG = 'button' as const\ninterface ButtonRenderPropArg {\n  open: boolean\n}\ntype ButtonPropsWeControl =\n  | 'id'\n  | 'type'\n  | 'aria-haspopup'\n  | 'aria-controls'\n  | 'aria-expanded'\n  | 'onKeyDown'\n  | 'onClick'\n\nlet Button = forwardRefWithAs(function Button<TTag extends ElementType = typeof DEFAULT_BUTTON_TAG>(\n  props: Props<TTag, ButtonRenderPropArg, ButtonPropsWeControl>,\n  ref: Ref<HTMLButtonElement>\n) {\n  let [state, dispatch] = useMenuContext([Menu.name, Button.name].join('.'))\n  let buttonRef = useSyncRefs(state.buttonRef, ref)\n\n  let id = `headlessui-menu-button-${useId()}`\n  let d = useDisposables()\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLButtonElement>) => {\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n\n        case Keys.Space:\n        case Keys.Enter:\n        case Keys.ArrowDown:\n          event.preventDefault()\n          event.stopPropagation()\n          dispatch({ type: ActionTypes.OpenMenu })\n          d.nextFrame(() => dispatch({ type: ActionTypes.GoToItem, focus: Focus.First }))\n          break\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          event.stopPropagation()\n          dispatch({ type: ActionTypes.OpenMenu })\n          d.nextFrame(() => dispatch({ type: ActionTypes.GoToItem, focus: Focus.Last }))\n          break\n      }\n    },\n    [dispatch, d]\n  )\n\n  let handleKeyUp = useCallback((event: ReactKeyboardEvent<HTMLButtonElement>) => {\n    switch (event.key) {\n      case Keys.Space:\n        // Required for firefox, event.preventDefault() in handleKeyDown for\n        // the Space key doesn't cancel the handleKeyUp, which in turn\n        // triggers a *click*.\n        event.preventDefault()\n        break\n    }\n  }, [])\n\n  let handleClick = useCallback(\n    (event: ReactMouseEvent) => {\n      if (isDisabledReactIssue7711(event.currentTarget)) return event.preventDefault()\n      if (props.disabled) return\n      if (state.menuState === MenuStates.Open) {\n        dispatch({ type: ActionTypes.CloseMenu })\n        d.nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n      } else {\n        event.preventDefault()\n        event.stopPropagation()\n        dispatch({ type: ActionTypes.OpenMenu })\n      }\n    },\n    [dispatch, d, state, props.disabled]\n  )\n\n  let slot = useMemo<ButtonRenderPropArg>(() => ({ open: state.menuState === MenuStates.Open }), [\n    state,\n  ])\n  let passthroughProps = props\n  let propsWeControl = {\n    ref: buttonRef,\n    id,\n    type: useResolveButtonType(props, state.buttonRef),\n    'aria-haspopup': true,\n    'aria-controls': state.itemsRef.current?.id,\n    'aria-expanded': props.disabled ? undefined : state.menuState === MenuStates.Open,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    onClick: handleClick,\n  }\n\n  return render({\n    props: { ...passthroughProps, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_BUTTON_TAG,\n    name: 'Menu.Button',\n  })\n})\n\n// ---\n\nlet DEFAULT_ITEMS_TAG = 'div' as const\ninterface ItemsRenderPropArg {\n  open: boolean\n}\ntype ItemsPropsWeControl =\n  | 'aria-activedescendant'\n  | 'aria-labelledby'\n  | 'id'\n  | 'onKeyDown'\n  | 'role'\n  | 'tabIndex'\n\nlet ItemsRenderFeatures = Features.RenderStrategy | Features.Static\n\nlet Items = forwardRefWithAs(function Items<TTag extends ElementType = typeof DEFAULT_ITEMS_TAG>(\n  props: Props<TTag, ItemsRenderPropArg, ItemsPropsWeControl> &\n    PropsForFeatures<typeof ItemsRenderFeatures>,\n  ref: Ref<HTMLDivElement>\n) {\n  let [state, dispatch] = useMenuContext([Menu.name, Items.name].join('.'))\n  let itemsRef = useSyncRefs(state.itemsRef, ref)\n\n  let id = `headlessui-menu-items-${useId()}`\n  let searchDisposables = useDisposables()\n\n  let usesOpenClosedState = useOpenClosed()\n  let visible = (() => {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open\n    }\n\n    return state.menuState === MenuStates.Open\n  })()\n\n  useEffect(() => {\n    let container = state.itemsRef.current\n    if (!container) return\n    if (state.menuState !== MenuStates.Open) return\n    if (container === document.activeElement) return\n\n    container.focus({ preventScroll: true })\n  }, [state.menuState, state.itemsRef])\n\n  useTreeWalker({\n    container: state.itemsRef.current,\n    enabled: state.menuState === MenuStates.Open,\n    accept(node) {\n      if (node.getAttribute('role') === 'menuitem') return NodeFilter.FILTER_REJECT\n      if (node.hasAttribute('role')) return NodeFilter.FILTER_SKIP\n      return NodeFilter.FILTER_ACCEPT\n    },\n    walk(node) {\n      node.setAttribute('role', 'none')\n    },\n  })\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLDivElement>) => {\n      searchDisposables.dispose()\n\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n\n        // @ts-expect-error Fallthrough is expected here\n        case Keys.Space:\n          if (state.searchQuery !== '') {\n            event.preventDefault()\n            event.stopPropagation()\n            return dispatch({ type: ActionTypes.Search, value: event.key })\n          }\n        // When in type ahead mode, fallthrough\n        case Keys.Enter:\n          event.preventDefault()\n          event.stopPropagation()\n          dispatch({ type: ActionTypes.CloseMenu })\n          if (state.activeItemIndex !== null) {\n            let { id } = state.items[state.activeItemIndex]\n            document.getElementById(id)?.click()\n          }\n          disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n          break\n\n        case Keys.ArrowDown:\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.Next })\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.Previous })\n\n        case Keys.Home:\n        case Keys.PageUp:\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.First })\n\n        case Keys.End:\n        case Keys.PageDown:\n          event.preventDefault()\n          event.stopPropagation()\n          return dispatch({ type: ActionTypes.GoToItem, focus: Focus.Last })\n\n        case Keys.Escape:\n          event.preventDefault()\n          event.stopPropagation()\n          dispatch({ type: ActionTypes.CloseMenu })\n          disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n          break\n\n        case Keys.Tab:\n          event.preventDefault()\n          event.stopPropagation()\n          break\n\n        default:\n          if (event.key.length === 1) {\n            dispatch({ type: ActionTypes.Search, value: event.key })\n            searchDisposables.setTimeout(() => dispatch({ type: ActionTypes.ClearSearch }), 350)\n          }\n          break\n      }\n    },\n    [dispatch, searchDisposables, state]\n  )\n\n  let handleKeyUp = useCallback((event: ReactKeyboardEvent<HTMLButtonElement>) => {\n    switch (event.key) {\n      case Keys.Space:\n        // Required for firefox, event.preventDefault() in handleKeyDown for\n        // the Space key doesn't cancel the handleKeyUp, which in turn\n        // triggers a *click*.\n        event.preventDefault()\n        break\n    }\n  }, [])\n\n  let slot = useMemo<ItemsRenderPropArg>(() => ({ open: state.menuState === MenuStates.Open }), [\n    state,\n  ])\n  let propsWeControl = {\n    'aria-activedescendant':\n      state.activeItemIndex === null ? undefined : state.items[state.activeItemIndex]?.id,\n    'aria-labelledby': state.buttonRef.current?.id,\n    id,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    role: 'menu',\n    tabIndex: 0,\n    ref: itemsRef,\n  }\n  let passthroughProps = props\n\n  return render({\n    props: { ...passthroughProps, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_ITEMS_TAG,\n    features: ItemsRenderFeatures,\n    visible,\n    name: 'Menu.Items',\n  })\n})\n\n// ---\n\nlet DEFAULT_ITEM_TAG = Fragment\ninterface ItemRenderPropArg {\n  active: boolean\n  disabled: boolean\n}\ntype MenuItemPropsWeControl =\n  | 'id'\n  | 'role'\n  | 'tabIndex'\n  | 'aria-disabled'\n  | 'onPointerLeave'\n  | 'onPointerMove'\n  | 'onMouseLeave'\n  | 'onMouseMove'\n  | 'onFocus'\n\nfunction Item<TTag extends ElementType = typeof DEFAULT_ITEM_TAG>(\n  props: Props<TTag, ItemRenderPropArg, MenuItemPropsWeControl> & {\n    disabled?: boolean\n    onClick?: (event: { preventDefault: Function }) => void\n  }\n) {\n  let { disabled = false, onClick, ...passthroughProps } = props\n  let [state, dispatch] = useMenuContext([Menu.name, Item.name].join('.'))\n  let id = `headlessui-menu-item-${useId()}`\n  let active = state.activeItemIndex !== null ? state.items[state.activeItemIndex].id === id : false\n\n  useIsoMorphicEffect(() => {\n    if (state.menuState !== MenuStates.Open) return\n    if (!active) return\n    let d = disposables()\n    d.nextFrame(() => document.getElementById(id)?.scrollIntoView?.({ block: 'nearest' }))\n    return d.dispose\n  }, [id, active, state.menuState])\n\n  let bag = useRef<MenuItemDataRef['current']>({ disabled })\n\n  useIsoMorphicEffect(() => {\n    bag.current.disabled = disabled\n  }, [bag, disabled])\n\n  useIsoMorphicEffect(() => {\n    bag.current.textValue = document.getElementById(id)?.textContent?.toLowerCase()\n  }, [bag, id])\n\n  useIsoMorphicEffect(() => {\n    dispatch({ type: ActionTypes.RegisterItem, id, dataRef: bag })\n    return () => dispatch({ type: ActionTypes.UnregisterItem, id })\n  }, [bag, id])\n\n  let handleClick = useCallback(\n    (event: MouseEvent) => {\n      if (disabled) return event.preventDefault()\n      dispatch({ type: ActionTypes.CloseMenu })\n      disposables().nextFrame(() => state.buttonRef.current?.focus({ preventScroll: true }))\n      if (onClick) return onClick(event)\n    },\n    [dispatch, state.buttonRef, disabled, onClick]\n  )\n\n  let handleFocus = useCallback(() => {\n    if (disabled) return dispatch({ type: ActionTypes.GoToItem, focus: Focus.Nothing })\n    dispatch({ type: ActionTypes.GoToItem, focus: Focus.Specific, id })\n  }, [disabled, id, dispatch])\n\n  let handleMove = useCallback(() => {\n    if (disabled) return\n    if (active) return\n    dispatch({ type: ActionTypes.GoToItem, focus: Focus.Specific, id })\n  }, [disabled, active, id, dispatch])\n\n  let handleLeave = useCallback(() => {\n    if (disabled) return\n    if (!active) return\n    dispatch({ type: ActionTypes.GoToItem, focus: Focus.Nothing })\n  }, [disabled, active, dispatch])\n\n  let slot = useMemo<ItemRenderPropArg>(() => ({ active, disabled }), [active, disabled])\n  let propsWeControl = {\n    id,\n    role: 'menuitem',\n    tabIndex: disabled === true ? undefined : -1,\n    'aria-disabled': disabled === true ? true : undefined,\n    disabled: undefined, // Never forward the `disabled` prop\n    onClick: handleClick,\n    onFocus: handleFocus,\n    onPointerMove: handleMove,\n    onMouseMove: handleMove,\n    onPointerLeave: handleLeave,\n    onMouseLeave: handleLeave,\n  }\n\n  return render({\n    props: { ...passthroughProps, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_ITEM_TAG,\n    name: 'Menu.Item',\n  })\n}\n\n// ---\n\nMenu.Button = Button\nMenu.Items = Items\nMenu.Item = Item\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}